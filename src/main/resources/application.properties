# --- Database Configuration ---
# The ?sslmode=require is necessary for Aiven/Neon cloud databases
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${DATABASE_USERNAME}
spring.datasource.password=${DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# --- Hibernate / JPA properties ---
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# --- Connection Pooling (HikariCP) ---
# Optimized for free tier to prevent "Too many connections" errors
spring.datasource.hikari.maximum-pool-size=4
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=600000

# --- Port Configuration ---
# Important: Koyeb/Render use this to assign the public port
server.port=${PORT:8080}

# --- Cloud Deployment Fix ---
# Ensures Hibernate handles PostgreSQL schemas correctly in cloud environments
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false